{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.233.0"},"children":{"TurkishLogisticsBot":{"id":"TurkishLogisticsBot","path":"TurkishLogisticsBot","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"RawMessagesBucket":{"id":"RawMessagesBucket","path":"TurkishLogisticsBot/RawMessagesBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/RawMessagesBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"turkish-logistics-raw-messages-426476636541","lifecycleConfiguration":{"rules":[{"id":"ArchiveOldMessages","status":"Enabled","transitions":[{"storageClass":"STANDARD_IA","transitionInDays":30},{"storageClass":"GLACIER","transitionInDays":90}]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true}}}}}},"MessageDLQ":{"id":"MessageDLQ","path":"TurkishLogisticsBot/MessageDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/MessageDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"fifoQueue":true,"messageRetentionPeriod":1209600,"queueName":"turkish-logistics-messages-dlq.fifo"}}}}},"MessageQueue":{"id":"MessageQueue","path":"TurkishLogisticsBot/MessageQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/MessageQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"contentBasedDeduplication":false,"fifoQueue":true,"queueName":"turkish-logistics-messages.fifo","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["MessageDLQ9DC2574C","Arn"]},"maxReceiveCount":3},"visibilityTimeout":60}}}}},"DatabaseSecret":{"id":"DatabaseSecret","path":"TurkishLogisticsBot/DatabaseSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/DatabaseSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Database connection string for Turkish Logistics Bot","generateSecretString":{"secretStringTemplate":"{\"host\":\"localhost\",\"port\":5432,\"database\":\"logistics\",\"username\":\"logistics\"}","generateStringKey":"password","excludePunctuation":true},"name":"turkish-logistics/database"}}}}},"WebhookApiKeySecret":{"id":"WebhookApiKeySecret","path":"TurkishLogisticsBot/WebhookApiKeySecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApiKeySecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"API key for Evolution API webhook authentication","generateSecretString":{"excludePunctuation":true,"passwordLength":32},"name":"turkish-logistics/webhook-api-key"}}}}},"WebhookHandler":{"id":"WebhookHandler","path":"TurkishLogisticsBot/WebhookHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"TurkishLogisticsBot/WebhookHandler/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"TurkishLogisticsBot/WebhookHandler/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookHandler/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"TurkishLogisticsBot/WebhookHandler/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookHandler/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"},{"Action":["s3:Abort*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["RawMessagesBucket7FC21897","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RawMessagesBucket7FC21897","Arn"]},"/*"]]}]},{"Action":["sqs:GetQueueAttributes","sqs:GetQueueUrl","sqs:SendMessage"],"Effect":"Allow","Resource":{"Fn::GetAtt":["MessageQueue7A3BF959","Arn"]}},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":{"Ref":"WebhookApiKeySecret568A065D"}}],"Version":"2012-10-17"},"policyName":"WebhookHandlerServiceRoleDefaultPolicyE376E30C","roles":[{"Ref":"WebhookHandlerServiceRoleF07A4D12"}]}}}}}}},"Code":{"id":"Code","path":"TurkishLogisticsBot/WebhookHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.233.0"},"children":{"Stage":{"id":"Stage","path":"TurkishLogisticsBot/WebhookHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.233.0"}},"AssetBucket":{"id":"AssetBucket","path":"TurkishLogisticsBot/WebhookHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.233.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-426476636541-eu-central-1","s3Key":"9d149a62a6f2ab74520b5c5d7d87f3236ed259a5f56158ebd45a87152dc60731.zip"},"environment":{"variables":{"MESSAGE_QUEUE_URL":{"Ref":"MessageQueue7A3BF959"},"RAW_MESSAGES_BUCKET":{"Ref":"RawMessagesBucket7FC21897"},"NODE_OPTIONS":"--enable-source-maps"}},"functionName":"turkish-logistics-webhook","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["WebhookHandlerServiceRoleF07A4D12","Arn"]},"runtime":"nodejs20.x","timeout":30,"tracingConfig":{"mode":"Active"}}}}}},"ProcessorHandler":{"id":"ProcessorHandler","path":"TurkishLogisticsBot/ProcessorHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"TurkishLogisticsBot/ProcessorHandler/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"TurkishLogisticsBot/ProcessorHandler/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/ProcessorHandler/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"TurkishLogisticsBot/ProcessorHandler/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/ProcessorHandler/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":{"Ref":"DatabaseSecret86DBB7B3"}},{"Action":["sqs:ChangeMessageVisibility","sqs:DeleteMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl","sqs:ReceiveMessage"],"Effect":"Allow","Resource":{"Fn::GetAtt":["MessageQueue7A3BF959","Arn"]}}],"Version":"2012-10-17"},"policyName":"ProcessorHandlerServiceRoleDefaultPolicyA484A7CA","roles":[{"Ref":"ProcessorHandlerServiceRoleC29770A9"}]}}}}}}},"Code":{"id":"Code","path":"TurkishLogisticsBot/ProcessorHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.233.0"},"children":{"Stage":{"id":"Stage","path":"TurkishLogisticsBot/ProcessorHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.233.0"}},"AssetBucket":{"id":"AssetBucket","path":"TurkishLogisticsBot/ProcessorHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.233.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/ProcessorHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-426476636541-eu-central-1","s3Key":"a6c00f6dc83b1db6c15ffb735f40c79bba3f3f882f355baff29f5864a7f4f773.zip"},"environment":{"variables":{"NODE_OPTIONS":"--enable-source-maps"}},"functionName":"turkish-logistics-processor","handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["ProcessorHandlerServiceRoleC29770A9","Arn"]},"runtime":"nodejs20.x","timeout":60,"tracingConfig":{"mode":"Active"}}}},"SqsEventSource:TurkishLogisticsBotMessageQueue20243C51":{"id":"SqsEventSource:TurkishLogisticsBotMessageQueue20243C51","path":"TurkishLogisticsBot/ProcessorHandler/SqsEventSource:TurkishLogisticsBotMessageQueue20243C51","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/ProcessorHandler/SqsEventSource:TurkishLogisticsBotMessageQueue20243C51/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":{"Fn::GetAtt":["MessageQueue7A3BF959","Arn"]},"functionName":{"Ref":"ProcessorHandler94663E8C"},"functionResponseTypes":["ReportBatchItemFailures"]}}}}}}},"ConversationsTable":{"id":"ConversationsTable","path":"TurkishLogisticsBot/ConversationsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/ConversationsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"pk","attributeType":"S"},{"attributeName":"sk","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"pk","keyType":"HASH"},{"attributeName":"sk","keyType":"RANGE"}],"tableName":"turkish-logistics-conversations","timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"TurkishLogisticsBot/ConversationsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}}}},"OpenAIApiKeySecret":{"id":"OpenAIApiKeySecret","path":"TurkishLogisticsBot/OpenAIApiKeySecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/OpenAIApiKeySecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"OpenAI API key for GPT agent","generateSecretString":{},"name":"turkish-logistics/openai-api-key"}}}}},"WhatsAppSecret":{"id":"WhatsAppSecret","path":"TurkishLogisticsBot/WhatsAppSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WhatsAppSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"WhatsApp Business API credentials","generateSecretString":{"secretStringTemplate":"{\"phoneNumberId\":\"YOUR_PHONE_NUMBER_ID\",\"verifyToken\":\"turkish-logistics-verify\",\"appSecret\":\"YOUR_APP_SECRET\"}","generateStringKey":"accessToken"},"name":"turkish-logistics/whatsapp"}}}}},"QueryHandler":{"id":"QueryHandler","path":"TurkishLogisticsBot/QueryHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"TurkishLogisticsBot/QueryHandler/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"TurkishLogisticsBot/QueryHandler/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/QueryHandler/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"TurkishLogisticsBot/QueryHandler/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/QueryHandler/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"},{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":{"Fn::GetAtt":["ConversationsTableCD91EB96","Arn"]}},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":[{"Ref":"DatabaseSecret86DBB7B3"},{"Ref":"OpenAIApiKeySecretA2160ED7"},{"Ref":"WhatsAppSecret66EA396B"}]}],"Version":"2012-10-17"},"policyName":"QueryHandlerServiceRoleDefaultPolicy4F3BC6F2","roles":[{"Ref":"QueryHandlerServiceRole1E45AE91"}]}}}}}}},"Code":{"id":"Code","path":"TurkishLogisticsBot/QueryHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.233.0"},"children":{"Stage":{"id":"Stage","path":"TurkishLogisticsBot/QueryHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.233.0"}},"AssetBucket":{"id":"AssetBucket","path":"TurkishLogisticsBot/QueryHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.233.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/QueryHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-426476636541-eu-central-1","s3Key":"a1a899157ec3ae18d96c18a204bc07a683fd1d7e7849e645c6b02fda623f13b7.zip"},"environment":{"variables":{"CONVERSATIONS_TABLE":{"Ref":"ConversationsTableCD91EB96"},"NODE_OPTIONS":"--enable-source-maps","NODE_TLS_REJECT_UNAUTHORIZED":"0"}},"functionName":"turkish-logistics-query","handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["QueryHandlerServiceRole1E45AE91","Arn"]},"runtime":"nodejs20.x","timeout":60,"tracingConfig":{"mode":"Active"}}}}}},"WebhookApi":{"id":"WebhookApi","path":"TurkishLogisticsBot/WebhookApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"Receives Evolution API webhooks","name":"Turkish Logistics Webhook API"}}},"Deployment":{"id":"Deployment","path":"TurkishLogisticsBot/WebhookApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Receives Evolution API webhooks","restApiId":{"Ref":"WebhookApi28122C53"}}}}}},"DeploymentStage.prod":{"id":"DeploymentStage.prod","path":"TurkishLogisticsBot/WebhookApi/DeploymentStage.prod","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/DeploymentStage.prod/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"WebhookApiDeployment5953494D3c0035a11ef825d447dde852fb47aca7"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"throttlingBurstLimit":200,"throttlingRateLimit":100}],"restApiId":{"Ref":"WebhookApi28122C53"},"stageName":"prod"}}}}},"Endpoint":{"id":"Endpoint","path":"TurkishLogisticsBot/WebhookApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Default":{"id":"Default","path":"TurkishLogisticsBot/WebhookApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.233.0","metadata":[]},"children":{"webhook":{"id":"webhook","path":"TurkishLogisticsBot/WebhookApi/Default/webhook","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/Default/webhook/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["WebhookApi28122C53","RootResourceId"]},"pathPart":"webhook","restApiId":{"Ref":"WebhookApi28122C53"}}}},"POST":{"id":"POST","path":"TurkishLogisticsBot/WebhookApi/Default/webhook/POST","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..webhook":{"id":"ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..webhook","path":"TurkishLogisticsBot/WebhookApi/Default/webhook/POST/ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..webhook","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WebhookHandler40BDAF19","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-central-1:426476636541:",{"Ref":"WebhookApi28122C53"},"/",{"Ref":"WebhookApiDeploymentStageprodF1908D9A"},"/POST/webhook"]]}}}},"ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..webhook":{"id":"ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..webhook","path":"TurkishLogisticsBot/WebhookApi/Default/webhook/POST/ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..webhook","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WebhookHandler40BDAF19","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-central-1:426476636541:",{"Ref":"WebhookApi28122C53"},"/test-invoke-stage/POST/webhook"]]}}}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/Default/webhook/POST/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"POST","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:eu-central-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["WebhookHandler40BDAF19","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"WebhookApiwebhook45FF8A56"},"restApiId":{"Ref":"WebhookApi28122C53"}}}}}}}},"query":{"id":"query","path":"TurkishLogisticsBot/WebhookApi/Default/query","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/Default/query/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["WebhookApi28122C53","RootResourceId"]},"pathPart":"query","restApiId":{"Ref":"WebhookApi28122C53"}}}},"GET":{"id":"GET","path":"TurkishLogisticsBot/WebhookApi/Default/query/GET","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.GET..query":{"id":"ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.GET..query","path":"TurkishLogisticsBot/WebhookApi/Default/query/GET/ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.GET..query","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["QueryHandler432DEBA0","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-central-1:426476636541:",{"Ref":"WebhookApi28122C53"},"/",{"Ref":"WebhookApiDeploymentStageprodF1908D9A"},"/GET/query"]]}}}},"ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.GET..query":{"id":"ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.GET..query","path":"TurkishLogisticsBot/WebhookApi/Default/query/GET/ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.GET..query","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["QueryHandler432DEBA0","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-central-1:426476636541:",{"Ref":"WebhookApi28122C53"},"/test-invoke-stage/GET/query"]]}}}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/Default/query/GET/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"GET","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:eu-central-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["QueryHandler432DEBA0","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"WebhookApiquery4E058700"},"restApiId":{"Ref":"WebhookApi28122C53"}}}}}},"POST":{"id":"POST","path":"TurkishLogisticsBot/WebhookApi/Default/query/POST","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..query":{"id":"ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..query","path":"TurkishLogisticsBot/WebhookApi/Default/query/POST/ApiPermission.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..query","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["QueryHandler432DEBA0","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-central-1:426476636541:",{"Ref":"WebhookApi28122C53"},"/",{"Ref":"WebhookApiDeploymentStageprodF1908D9A"},"/POST/query"]]}}}},"ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..query":{"id":"ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..query","path":"TurkishLogisticsBot/WebhookApi/Default/query/POST/ApiPermission.Test.TurkishLogisticsBotWebhookApi4BE2F5E2.POST..query","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["QueryHandler432DEBA0","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-central-1:426476636541:",{"Ref":"WebhookApi28122C53"},"/test-invoke-stage/POST/query"]]}}}},"Resource":{"id":"Resource","path":"TurkishLogisticsBot/WebhookApi/Default/query/POST/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"POST","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:eu-central-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["QueryHandler432DEBA0","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"WebhookApiquery4E058700"},"restApiId":{"Ref":"WebhookApi28122C53"}}}}}}}}}}}},"WebhookUrl":{"id":"WebhookUrl","path":"TurkishLogisticsBot/WebhookUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"QueryWebhookUrl":{"id":"QueryWebhookUrl","path":"TurkishLogisticsBot/QueryWebhookUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"RawMessagesBucketName":{"id":"RawMessagesBucketName","path":"TurkishLogisticsBot/RawMessagesBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"MessageQueueUrl":{"id":"MessageQueueUrl","path":"TurkishLogisticsBot/MessageQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DatabaseSecretArn":{"id":"DatabaseSecretArn","path":"TurkishLogisticsBot/DatabaseSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"WebhookApiKeySecretArn":{"id":"WebhookApiKeySecretArn","path":"TurkishLogisticsBot/WebhookApiKeySecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"ConversationsTableName":{"id":"ConversationsTableName","path":"TurkishLogisticsBot/ConversationsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"OpenAIApiKeySecretArn":{"id":"OpenAIApiKeySecretArn","path":"TurkishLogisticsBot/OpenAIApiKeySecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"WhatsAppSecretArn":{"id":"WhatsAppSecretArn","path":"TurkishLogisticsBot/WhatsAppSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"TurkishLogisticsBot/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"TurkishLogisticsBot/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"TurkishLogisticsBot/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"TurkishLogisticsBot/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}}}}}